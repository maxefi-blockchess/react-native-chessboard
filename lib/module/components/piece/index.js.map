{"version":3,"names":["React","useCallback","useImperativeHandle","useMemo","useState","Gesture","GestureDetector","Animated","runOnJS","useAnimatedStyle","useDerivedValue","useSharedValue","withTiming","useChessboardProps","useBoardOperations","useBoardPromotion","usePieceRefs","useChessEngine","useReversePiecePosition","ChessPiece","Piece","memo","forwardRef","ref","id","startPosition","square","size","chess","refs","pieceEnabled","isPromoting","onSelectPiece","onMove","selectedSquare","turn","isPieceGestureInProgress","setIsPieceGestureInProgress","isPieceActive","setIsPieceActive","pieceSize","durations","move","moveDuration","gestureEnabled","gestureEnabledFromChessboardProps","playersColor","value","charAt","toPosition","toTranslation","isGestureActive","offsetX","offsetY","borderColor","translateX","x","translateY","y","validateMove","from","to","moves","verbose","find","m","wrappedOnMoveForJSThread","moveTo","Promise","resolve","duration","isFinished","undefined","movePiece","enable","active","onStartTap","globalMoveTo","current","handleOnBegin","currentSquare","previousTappedSquare","gestureProgress","Pan","enabled","onBegin","onStart","onUpdate","translationX","translationY","onEnd","onFinalize","gestureDisabled","gesture","style","justifyContent","alignItems","position","zIndex","toFixed","borderWidth","backgroundColor","boxSize","width","height","transform","underlay","translation","borderRadius","prev","next"],"sources":["index.tsx"],"sourcesContent":["import type { Move, Square } from 'chess.js';\nimport React, {\n  useCallback,\n  useImperativeHandle,\n  useMemo,\n  useState,\n} from 'react';\nimport { Gesture, GestureDetector } from 'react-native-gesture-handler';\nimport Animated, {\n  runOnJS,\n  useAnimatedStyle,\n  useDerivedValue,\n  useSharedValue,\n  withTiming,\n} from 'react-native-reanimated';\nimport { useChessboardProps } from '../../context/props-context/hooks';\nimport { useBoardOperations } from '../../context/board-operations-context/hooks';\nimport { useBoardPromotion } from '../../context/board-promotion-context/hooks';\nimport { usePieceRefs } from '../../context/board-refs-context/hooks';\nimport { useChessEngine } from '../../context/chess-engine-context/hooks';\nimport { useReversePiecePosition } from '../../notation';\nimport type { PieceType, Vector } from '../../types';\n\nimport { ChessPiece } from './visual-piece';\n\ntype PieceProps = {\n  id: PieceType;\n  startPosition: Vector;\n  square: Square;\n  size: number;\n};\n\nexport type ChessPieceRef = {\n  moveTo: (square: Square) => Promise<Move | undefined>;\n  enable: (activate: boolean) => void;\n};\n\nconst Piece = React.memo(\n  React.forwardRef<ChessPieceRef, PieceProps>(\n    ({ id, startPosition, square, size }, ref) => {\n      const chess = useChessEngine();\n      const refs = usePieceRefs();\n      const pieceEnabled = useSharedValue(true);\n      const { isPromoting } = useBoardPromotion();\n      const {\n        onSelectPiece,\n        onMove,\n        selectedSquare,\n        turn,\n        isPieceGestureInProgress,\n        setIsPieceGestureInProgress,\n      } = useBoardOperations();\n\n      const [isPieceActive, setIsPieceActive] = useState<boolean>(false);\n\n      const {\n        pieceSize,\n        durations: { move: moveDuration },\n        gestureEnabled: gestureEnabledFromChessboardProps,\n        playersColor,\n      } = useChessboardProps();\n\n      const gestureEnabled = useDerivedValue(\n        () =>\n          turn.value === id.charAt(0) &&\n          turn.value === playersColor &&\n          gestureEnabledFromChessboardProps,\n        [id, gestureEnabledFromChessboardProps]\n      );\n\n      const { toPosition, toTranslation } = useReversePiecePosition();\n\n      const isGestureActive = useSharedValue(false);\n      const offsetX = useSharedValue(0);\n      const offsetY = useSharedValue(0);\n      const borderColor = useSharedValue(1);\n      const translateX = useSharedValue(startPosition.x * size);\n      const translateY = useSharedValue(startPosition.y * size);\n\n      const validateMove = useCallback(\n        (from: Square, to: Square) => {\n          return chess\n            .moves({ verbose: true })\n            .find((m) => m.from === from && m.to === to);\n        },\n        [chess]\n      );\n\n      const wrappedOnMoveForJSThread = useCallback(\n        ({ move }: { move: Move }) => {\n          onMove(move.from, move.to);\n        },\n        [onMove]\n      );\n\n      const moveTo = useCallback(\n        (from: Square, to: Square) => {\n          return new Promise<Move | undefined>((resolve) => {\n            const move = validateMove(from, to);\n            const { x, y } = toTranslation(move ? move.to : from);\n            translateX.value = withTiming(x, { duration: moveDuration }, () => {\n              offsetX.value = translateX.value;\n            });\n            translateY.value = withTiming(\n              y,\n              { duration: moveDuration },\n              (isFinished) => {\n                if (!isFinished) return;\n                offsetY.value = translateY.value;\n                isGestureActive.value = false;\n                if (move) {\n                  runOnJS(wrappedOnMoveForJSThread)({ move });\n                  // Ideally I must call the resolve method\n                  // inside the \"wrappedOnMoveForJSThread\" after\n                  // the \"onMove\" function.\n                  // Unfortunately I'm not able to pass a\n                  // function in the RunOnJS params\n                  runOnJS(resolve)(move);\n                } else {\n                  runOnJS(resolve)(undefined);\n                }\n              }\n            );\n          });\n        },\n        [\n          isGestureActive,\n          moveDuration,\n          offsetX,\n          offsetY,\n          toTranslation,\n          translateX,\n          translateY,\n          validateMove,\n          wrappedOnMoveForJSThread,\n        ]\n      );\n\n      const movePiece = useCallback(\n        (to: Square) => {\n          const from = toPosition({ x: offsetX.value, y: offsetY.value });\n          moveTo(from, to);\n        },\n        [moveTo, offsetX.value, offsetY.value, toPosition]\n      );\n\n      useImperativeHandle(\n        ref,\n        () => {\n          return {\n            moveTo: (to: Square) => {\n              return moveTo(square, to);\n            },\n            enable: (active: boolean) => {\n              pieceEnabled.value = active;\n            },\n          };\n        },\n        [moveTo, pieceEnabled, square]\n      );\n\n      const onStartTap = useCallback(\n        // eslint-disable-next-line no-shadow\n        (square: Square) => {\n          'worklet';\n          if (!onSelectPiece) {\n            return;\n          }\n          runOnJS(onSelectPiece)(square);\n        },\n        [onSelectPiece]\n      );\n\n      const globalMoveTo = useCallback(\n        (move: Move) => {\n          refs?.current?.[move.from].current?.moveTo?.(move.to);\n        },\n        [refs]\n      );\n\n      const handleOnBegin = useCallback(() => {\n        const currentSquare = toPosition({\n          x: translateX.value,\n          y: translateY.value,\n        });\n\n        const previousTappedSquare = selectedSquare.value;\n        const move =\n          previousTappedSquare &&\n          validateMove(previousTappedSquare, currentSquare);\n\n        if (move) {\n          runOnJS(globalMoveTo)(move);\n          return;\n        }\n        if (!gestureEnabled.value) return;\n        borderColor.value = withTiming(0);\n        onStartTap(square);\n      }, [\n        borderColor,\n        gestureEnabled.value,\n        globalMoveTo,\n        onStartTap,\n        selectedSquare.value,\n        square,\n        toPosition,\n        translateX.value,\n        translateY.value,\n        validateMove,\n      ]);\n\n      const gestureProgress = Gesture.Pan()\n        .enabled(!isPromoting && pieceEnabled.value)\n        .onBegin(() => {\n          runOnJS(setIsPieceActive)(true);\n          runOnJS(setIsPieceGestureInProgress)(true);\n          offsetX.value = translateX.value;\n          offsetY.value = translateY.value;\n          runOnJS(handleOnBegin)();\n        })\n        .onStart(() => {\n          if (!gestureEnabled.value) return;\n          isGestureActive.value = true;\n        })\n        .onUpdate(({ translationX, translationY }) => {\n          if (!gestureEnabled.value) return;\n          translateX.value = offsetX.value + translationX;\n          translateY.value = offsetY.value + translationY;\n        })\n        .onEnd(() => {\n          if (!gestureEnabled.value) return;\n          runOnJS(movePiece)(\n            toPosition({ x: translateX.value, y: translateY.value })\n          );\n        })\n        .onFinalize(() => {\n          runOnJS(setIsPieceActive)(false);\n          runOnJS(setIsPieceGestureInProgress)(false);\n          borderColor.value = withTiming(1);\n        });\n\n      const gestureDisabled = Gesture.Pan().enabled(false);\n\n      const gesture = useMemo(() => {\n        if (isPieceGestureInProgress && !isPieceActive) {\n          return gestureDisabled;\n        }\n\n        return gestureProgress;\n      }, [\n        isPieceGestureInProgress,\n        isPieceActive,\n        gestureProgress,\n        gestureDisabled,\n      ]);\n\n      const style = useAnimatedStyle(() => {\n        return {\n          justifyContent: 'center',\n          alignItems: 'center',\n          position: 'absolute',\n          zIndex: selectedSquare.value ? 100 : 10,\n          borderColor:\n            selectedSquare.value === square\n              ? `rgba(44, 141, 255,${borderColor.value.toFixed(2)})`\n              : 'transparent',\n          borderWidth: 1,\n          backgroundColor:\n            selectedSquare.value === square && !isGestureActive.value\n              ? `rgba(44, 141, 255, ${(borderColor.value / 5).toFixed(2)})`\n              : 'transparent',\n          boxSize: 'border-box',\n          width: pieceSize,\n          height: pieceSize,\n          transform: [\n            { translateX: translateX.value },\n            { translateY: translateY.value },\n          ],\n        };\n      }, [selectedSquare.value]);\n\n      const underlay = useAnimatedStyle(() => {\n        const position = toPosition({\n          x: translateX.value,\n          y: translateY.value,\n        });\n        const translation = toTranslation(position);\n        return {\n          position: 'absolute',\n          width: size * 2,\n          height: size * 2,\n          borderRadius: size,\n          zIndex: 0,\n          backgroundColor: 'transparent',\n          transform: [\n            { translateX: translation.x - size / 2 },\n            { translateY: translation.y - size / 2 },\n          ],\n        };\n      }, [size]);\n\n      return (\n        <>\n          <Animated.View style={underlay} />\n          <GestureDetector gesture={gesture}>\n            <Animated.View style={style}>\n              <ChessPiece id={id} />\n            </Animated.View>\n          </GestureDetector>\n        </>\n      );\n    }\n  ),\n  (prev, next) =>\n    prev.id === next.id &&\n    prev.size === next.size &&\n    prev.square === next.square\n);\n\nexport default Piece;\n"],"mappings":"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"}